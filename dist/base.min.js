/* base.min.js v0.0.26 */ 
!function(Ractive){Ractive.adaptors.backboneAssociatedModel=function(model,path){var settingModel,settingView,setModel,setView,pathMatcher,pathLength,prefix,modelChangeEventHandler;return path&&(path+=".",pathMatcher=new RegExp("^"+path.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")),pathLength=path.length),modelChangeEventHandler=function(eventName){var eventNameSplit,eventType,keypath,value;eventNameSplit=eventName.split(":"),eventType=eventNameSplit[0],keypath=eventNameSplit[1],"change"===eventType&&keypath&&(value=model.get(keypath),value&&value.toJSON&&(value=value.toJSON(!0)),setView(keypath,value))},{init:function(view){path?(prefix=function(attrs){var attr,result;result={};for(attr in attrs)({}).hasOwnProperty.call(attrs,attr)&&(result[path+attr]=attrs[attr]);return result},setView=function(keypath,value){if(!settingModel){settingView=!0;var changed={};changed[keypath]=value,view.set(prefix(model.changed)),settingView=!1}},setModel=function(keypath,value){settingView||pathMatcher.test(keypath)&&(settingModel=!0,model.set(keypath.substring(pathLength),value),settingModel=!1)}):(setView=function(keypath,value){settingModel||(settingView=!0,view.set(keypath,value),settingView=!1)},setModel=function(keypath,value){settingView||(settingModel=!0,model.set(keypath,value),settingModel=!1)}),model.on("all",modelChangeEventHandler),view.on("set",setModel),view.set(path?prefix(model.toJSON(!0)):model.toJSON(!0))},teardown:function(view){model.off("all",modelChangeEventHandler),view.off("set",setModel)}}}}(window.Ractive||require&&require("ractive")),function(){var Base,BasicView,DOMEventList,Ractive,addState,appSurrogate,arr,callbackStringSplitter,camelize,capitalize,className,currentApp,dasherize,deserialize,getModuleArgs,invokeModule,invokeWithArgs,method,module,moduleQueue,moduleType,moduleTypes,originalBase,parseRequirements,prepareModule,subject,type,uncapitalize,_base,_fn,_fn1,_fn2,_i,_j,_k,_l,_len,_len1,_len2,_len3,_len4,_len5,_len6,_len7,_m,_n,_o,_p,_ref,_ref1,_ref2,_ref3,_ref4,_ref5,_ref6,_ref7,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},__slice=[].slice,__indexOf=[].indexOf||function(item){for(var i=0,l=this.length;l>i;i++)if(i in this&&this[i]===item)return i;return-1};for(originalBase=window.Base,currentApp=null,appSurrogate={singletons:{}},null==window._JST&&(window._JST={}),Ractive=window.Ractive||("function"==typeof window.require?require("Ractive"):void 0),arr=[],callbackStringSplitter=/\s*[,:()]+\s*/,DOMEventList="blur, focus, focusin, focusout, load, resize, scroll,  unload, click, dblclick, mousedown, mouseup, mousemove, mouseover,  mouseout, mouseenter, mouseleave, change, select, submit, keydown,  keypress, keyup, error, touchstart, touchend, touchmove".split(/\s*,\s*/),null==Function.prototype.name&&null!=Object.defineProperty&&Object.defineProperty(Function.prototype,"name",{get:function(){var funcNameRegex,results;return funcNameRegex=/function\s+(.{1,})\s*\(/,results=funcNameRegex.exec(this.toString()),results&&results.length>1?results[1]:""},set:function(){}}),Base=function(){function Base(){Base.__super__.constructor.apply(this,arguments)}return Base}(),Base.noConflict=function(){return window.Base=originalBase,Base},null==Base.$&&(Base.$=window.$||window.jQuery||window.Zepto),Base.config={debug:{logModelChanges:!1}},Base.View=function(_super){function View(options){var config,key,plugins,type,value,_base,_i,_len,_ref,_ref1,_this=this;for(this.options=null!=options?options:{},null==this.name&&(this.name=this.constructor.name),null==this.attributes&&(this.attributes={}),null==(_base=this.attributes)["data-view"]&&(_base["data-view"]=dasherize(this.name.replace(/view/i,""))),null==this.children&&(this.children=new Base.List(this.options.children||[])),null==this.ractive&&(this.ractive=!0),this.options.parent&&null==this.parent&&(this.parent=this.options.parent),this.stateOptions=_.defaults(this.stateOptions||{},{relations:this.relations,compute:this.compute}),null==this.relations&&(this.relations={}),this.relations.$state=Base.State,addState(this),this._bindEvents(),View.__super__.constructor.apply(this,arguments),this._bindAttributes(),plugins=_.result(this,"plugins"),_ref=["view","all"],_i=0,_len=_ref.length;_len>_i;_i++){type=_ref[_i],_ref1=Base.plugins[type];for(key in _ref1)value=_ref1[key],config=plugins&&plugins[key]||Base.defaults[type].plugins[key],config&&value.call(this,this,config)}this._bindEventMethods(),this.state.on("all",function(){var args;return args=1<=arguments.length?__slice.call(arguments,0):[],_this.trigger.apply(_this,args)}),this.trigger("init"),this.$el.data("view",this),this._bindEventBubbling(),this._bindSpecialCallbacks(),this._bindSpecialEventMethods()}return __extends(View,_super),View.prototype.moduleType="view",View.prototype.lookup=function(keypath){var parent,value;for(parent=this;parent=parent.parent;)if(value=parent.get(keypath),null!=value)return value},View.prototype.require=function(){},View.prototype.define=function(){},View.prototype._bindAttributes=function(){var attr,_i,_len,_ref,_results,_this=this;if(this.bindAttributes){for(_ref=this.bindAttributes,_results=[],_i=0,_len=_ref.length;_len>_i;_i++)attr=_ref[_i],_results.push(function(attr){var domAttr;return domAttr=dasherize(attr),_this.$el.attr("data-"+domAttr,_this.get(attr)),_this.on("change:"+attr,function(model,value){return _this.$el.attr("data-"+domAttr,value)})}(attr));return _results}},View.prototype._bindEventMethods=function(){var cb,event,_i,_len,_results;for(_results=[],_i=0,_len=DOMEventList.length;_len>_i;_i++)event=DOMEventList[_i],cb=this["on"+capitalize(event)],cb?_results.push(this.$el.on(""+event+".delegateEvents",cb.bind(this))):_results.push(void 0);return _results},View.prototype._getCallback=function(str,allowString){var args,split,value,_ref;return _.isFunction(str)?str:(split=_.compact(str.split(callbackStringSplitter)),!split[1]&&allowString?str:(args=function(){var _i,_len,_ref,_results;for(_ref=split.slice(1),_results=[],_i=0,_len=_ref.length;_len>_i;_i++)value=_ref[_i],_results.push(deserialize(value));return _results}(),(_ref=this[split[0]]).bind.apply(_ref,[this].concat(__slice.call(args)))))},View.prototype._bindEvents=function(){var $el,callback,eventName,item,key,name,prefix,selector,value,_base,_i,_len,_ref,_ref1,_ref2,_ref3,_results;if(this.events){_ref=this.events;for(key in _ref)value=_ref[key],value&&value.split&&callbackStringSplitter.test(value)&&(this.events[key]=this._getCallback(value))}"object"!=typeof this.bind&&(this.bind={});for(key in this)for(value=this[key],_ref1=["document","window"],_i=0,_len=_ref1.length;_len>_i;_i++)item=_ref1[_i],prefix="on"+capitalize(item),0===key.indexOf(prefix)&&(null==(_base=this.bind)[item]&&(_base[item]={}),this.bind[item][key.split(prefix)[1].toLowerCase()]=value);_ref2=this.bind,_results=[];for(key in _ref2)value=_ref2[key],"function"==(_ref3=typeof value)||"string"===_ref3?value?_results.push(this.on(key,this._getCallback(value).bind(this))):_results.push(void 0):"document"===key||"window"===key?(selector="document"===key?document:window,$el=$(selector),_results.push(function(){var _results1;_results1=[];for(name in value)callback=value[name],_results1.push($el.on(""+name+".delegateEvents-"+this.cid,this._getCallback(callback).bind(this)));return _results1}.call(this))):_results.push(function(){var _results1;_results1=[];for(eventName in value)callback=value[eventName],callback?_results1.push(this.on(""+key+":"+eventName,this._getCallback(callback).bind(this))):_results1.push(void 0);return _results1}.call(this));return _results},View.prototype.render=function(dontRerender){return dontRerender&&this._hasRendered?void 0:(this._hasRendered=!0,this.trigger("before:render"),this.beforeRender&&this.beforeRender(),this.ractive&&this._initRactive(),this.trigger("render"),this._bindComponents(),this.afterRender&&this.afterRender(),this.trigger("after:render"))},View.prototype._bindSpecialEventMethods=function(){var _this=this;return this.on("all",function(){var args,camelized,event,method;return event=arguments[0],args=2<=arguments.length?__slice.call(arguments,1):[],(camelized=camelize(event))?(method=_this["on"+camelized[0].toUpperCase()+camelized.substring(1)],"array"!==type(args[0])||args[0].length||console.log("special method args",args),method?method.apply(_this,args):void 0):void 0})},View.prototype._bindSpecialCallbacks=function(){var key,split,value,_ref,_results,_this=this;_ref=this.events,_results=[];for(key in _ref)if(value=_ref[key],"string"==typeof value)if(split=value.split(":"),split[1])switch(spit[0]){case"set":_results.push(this.events[key]=function(){return _this.set(split[1].trim(),_this.get(split[2].trim()))});break;case"toggle":_results.push(this.events[key]=function(){return _this.toggle(split[1])});break;default:_results.push(void 0)}else _results.push(void 0);else _results.push(void 0);return _results},View.prototype._bindComponents=function(){var key,value,_ref,_results,_this=this;_ref=Base.components,_results=[];for(key in _ref)value=_ref[key],_results.push(this.$el.find("x-"+key+", base-"+key).each(function(index,el){var $el,attr,attrs,_i,_len,_ref1;for($el=$(el),attrs={},_ref1=el.attributes,_i=0,_len=_ref1.length;_len>_i;_i++)attr=_ref1[_i],attrs[camelize(attr.name)]=attr.value;return value.call(_this,$el,_this,attrs)}));return _results},View.prototype._parseObjectGetter=function(str){return str},View.prototype._parseTemplate=function(){},View.prototype._parseDOM=function(){var parse,res;return parse=function(el){var attr,attrs,child,index,item,name,odd,props,split,value,_i,_j,_len,_len1,_ref,_results;for(attrs={},_ref=el.attributes,_results=[],_i=0,_len=_ref.length;_len>_i;_i++){if(attr=_ref[_i],name=attr.name,value=attr.value,arr=attrs[name]=[],/\{\{.*\}\}/.test(value))for(split=arr.split(/\{\{|\}\}/),index=_j=0,_len1=split.length;_len1>_j;index=++_j)item=split[index],odd=index%2,odd?(props=_.compact(item.split(/\s+|[\(\)+=-><%\/&!^\|]+/)),arr.push({fn:new Function("return "+item),props:props})):arr.push(item);_results.push({attrs:attrs,children:function(){var _k,_len2,_ref1,_results1;for(_ref1=el.chidren,_results1=[],_k=0,_len2=_ref1.length;_len2>_k;_k++)child=_ref1[_k],_results1.push(parse(child));return _results1}()})}return _results},res=parse(this.el)},View.prototype._initRactive=function(){var adaptor,filters,key,parent,parentName,parents,template,templateName,val,value,_i,_len,_ref,_results,_this=this;if(this.options&&this.options.ractive||this.ractive){filters=_.clone(Base.filters);for(key in filters)value=filters[key],value&&value.bind&&(filters[key]=value.bind(this));templateName="src/templates/views/"+dasherize(this.name)+".html",template=this.template||_.clone(_JST[templateName])||this.$el.html(),this.ractive=new Ractive({el:this.el,template:template,data:_.extend(this.toJSON(),{$view:this,$filter:Base.filters,$base:Base})});for(key in this)val=this[key],"function"==typeof val&&"_"!==key[0]&&!function(key,val){return _this.ractive.on(key,function(event,argString){var argArray,args,stringRe;return null==argString&&(argString=""),"set"!==key||event.original?("string"!=typeof argString&&(argString=""),stringRe=/^(?:'(.*?)'|"(.*?)")$/,argArray=_.compact(argString.split(/\s*[:,]+\s*/)),args=argArray.map(function(arg){var deserialized,isString,keyPath,keypath;return arg=arg.trim(),(isString=stringRe.test(arg))?RegExp.$1||RegExp.$2:(deserialized=deserialize(arg),"string"!=typeof deserialized?deserialized:("."===arg?keypath=event.keyPath:arg&&"."===arg[0]?keypath=""+event.keyPath+arg:keyPath=arg,_this.get(arg)))}),args.push(event.original),val.apply(_this,args)):void 0})}(key,val);for(adaptor=Ractive.adaptors.backboneAssociatedModel,this.ractive.bind(adaptor(this.state)),this.ractive.bind(adaptor(currentApp.state,"$app")),currentApp.router&&this.ractive.bind(adaptor(currentApp.router.state,"$router")),parents=[],parent=this;parent=parent.parent;)parents.push(parent);for(_i=0,_len=parents.length;_len>_i;_i++)parent=parents[_i],parentName=uncapitalize(parent.name),this.ractive.bind(adaptor(parent.state,"$parent."+parentName));_ref=currentApp.singletons,_results=[];for(key in _ref)val=_ref[key],val instanceof Base.Model||val instanceof Base.Collection?_results.push(this.ractive.bind(adaptor(val,"$"+key))):_results.push(void 0);return _results}},View.prototype._bindEventBubbling=function(){var _this=this;return this.on("all",function(){var args;return args=1<=arguments.length?__slice.call(arguments,0):[],_this.broadcast.apply(_this,args),_this.emit.apply(_this,args)})},View.prototype.trigger=function(){var args,eventName;return eventName=arguments[0],args=2<=arguments.length?__slice.call(arguments,1):[],args[0]instanceof Base.Event?args[0].currentTarget=this:args.unshift(new Base.Event({name:eventName,target:this,currentTarget:this})),View.__super__.trigger.apply(this,arguments)},View.prototype.get=function(path){var subject,truePath;if(path)return subject=this.state,truePath=path,0===path.indexOf("$")&&(truePath=path.split(".").slice(1).join("."),subject=0===path.indexOf("$app.")?app:currentApp.singletons[path.split(".")[0].substring(1)]),subject.get(truePath)},View.prototype.subView=function(){var args,name,view;if(args=1<=arguments.length?__slice.call(arguments,0):[],args[1])view=args[1],name=args[0];else{if("string"==typeof args[0])return this.childView(args[0]);view=args[0]}return view?(view instanceof Base.View||(view=new view),view.__viewName__=name,view.parent=this,this.children.push(view),view):(console.warn("No view passed to subView",args,arguments),void 0)},View.prototype.insertView=function(selector,view){return view||(view=selector,selector=null),this.subView(view),selector?this.$(selector).append(view.$el):this.$el.append(view.$el),this},View.prototype.parentView=function(arg,findOne){return this.parentViews(arg,findOne)},View.prototype.findView=function(arg){return this.findViews(arg,!0)},View.prototype.childView=function(arg){return this.childViews(arg,!0)},View.prototype.destroyView=function(arg,all){var child;return child=all?this.findView(arg):this.childView(arg),child&&child.destroy(),child},View.prototype.destroyViews=function(arg,all){var child,children,_i,_len;for(children=all?this.findViews(arg):this.childViews(arg),_i=0,_len=children.length;_len>_i;_i++)child=children[_i],child.destroy();return children},View.prototype.childViews=function(arg,findOne){return this.findViews(arg,findOne,!0)},View.prototype.parentViews=function(arg,findOne){var parent,res;if(res=[],arg){for(parent=this;parent=parent.parent;)if(parent.is&&parent.is(arg)){if(findOne)return parent;res.push(parent)}}else{if(findOne)return this.parent;res.push(this.parent)}return res},View.prototype.findViews=function(arg,findOne,shallow){var foundView,recurse,views;return views=[],foundView=void 0,recurse=function(view){var childView,_i,_len,_ref,_results;for(_ref=view.children,_results=[],_i=0,_len=_ref.length;_len>_i;_i++){if(childView=_ref[_i],childView.is(arg)&&(views.push(childView),findOne)){foundView=childView;break}childView&&!shallow?_results.push(recurse(childView)):_results.push(void 0)}return _results},recurse(this),findOne?foundView:views},View.prototype.is=function(arg){var key,name,str,strip,thisKey,value;if(!arg||arg===this)return!0;switch(typeof arg){case"string":return strip=function(str){return str.toLowerCase().replace(/view$/i,"")},str=strip(arg),name=this.__viewName__,strip(this.name||"")===str||strip(name||"")===str;case"function":return!!arg(this);default:for(key in arg)if(value=arg[key],thisKey=this.get(key),null==thisKey&&(thisKey=this[key]),value!==thisKey)return!1;return!0}},View.prototype.destroy=function(){return this.ractive&&this.ractive.off&&(this.ractive.teardown(),this.ractive.unbind()),Base.$([document,window]).off(".delegateEvents-"+this.cid),this.state.off(),this.state.stopListening(),this.state.cleanup()&&this.state.cleanup(),this.trigger("destroy"),this.cleanup&&this.cleanup(),this.$el.removeData("view"),this.$el.off(),this.off(),this.undelegateEvents(),this.remove(),this.parent?this.parent.children.splice(this.parent.children.indexOf(this),1):void 0},View.prototype.request=function(){var args,callback,event,eventName,eventObj,parent,response,_results;for(eventName=arguments[0],args=2<=arguments.length?__slice.call(arguments,1):[],parent=this,_results=[];parent=parent.parent;){if(eventObj=parent["onRequest"+capitalize(eventName)]||_.last(parent._events["request:"+eventName])){event=new Base.Event({type:"request",target:this}),callback=eventObj.callback||eventObj,response=callback.call.apply(callback,[eventObj.ctx||parent,event].concat(__slice.call(args)));break}_results.push(void 0)}return _results},View.prototype.emit=function(){var args,event,eventName,name,newEvent,parent,_i,_len,_ref,_results;if(eventName=arguments[0],args=2<=arguments.length?__slice.call(arguments,1):[],parent=this.parent)if(/^(child:|request:)/.test(eventName)){if(event=args[0],null==event&&(event=new Base.Event({type:eventName,target:this})),!event.propagationStopped)return event.currentTarget=parent,parent.trigger.apply(parent,arguments)}else if(!/^(app:|parent:|firstChild:|firstParent:)/.test(eventName)){for(name=uncapitalize(this.name),event=new Base.Event({name:eventName,target:this,currentTarget:parent}),_ref=["child:"+eventName,"child:"+name+":"+eventName,"firstChild:"+eventName,"firstChild:"+name+":"+eventName],_results=[],_i=0,_len=_ref.length;_len>_i;_i++)newEvent=_ref[_i],_results.push(parent.trigger.apply(parent,[newEvent,event].concat(__slice.call(args))));return _results}},View.prototype.broadcast=function(){var args,child,event,eventName,name,newEvent,_i,_j,_k,_len,_len1,_len2,_ref,_ref1,_ref2;if(eventName=arguments[0],args=2<=arguments.length?__slice.call(arguments,1):[],this.children)if(/^(parent:|app:)/.test(eventName)){if(event=args[0]||new Base.Event({type:eventName,target:this}),!event.propagationStopped)for(event.currentTarget=child,_ref=this.children,_i=0,_len=_ref.length;_len>_i;_i++){if(child=_ref[_i],event.propagationStopped)return;child.trigger.apply(child,arguments)}}else if(!/^(child:|request:|firstParent:|firstChild:)/.test(eventName))for(name=uncapitalize(this.name),event=new Base.Event({name:eventName,target:this}),_ref1=this.children,_j=0,_len1=_ref1.length;_len1>_j;_j++)for(child=_ref1[_j],event.currentTarget=child,_ref2=["parent:"+eventName,"parent:"+name+":"+eventName,"firstParent:"+eventName,"firstParent:"+name+":"+eventName],_k=0,_len2=_ref2.length;_len2>_k;_k++){if(newEvent=_ref2[_k],event.propagationStopped)return;child.trigger.apply(child,[newEvent,event].concat(__slice.call(args)))}},View}(Backbone.View),Base.App=function(_super){function App(options){var $win,key,value,_this=this;this.options=options,currentApp=this;for(key in appSurrogate)value=appSurrogate[key],null==currentApp[key]&&(currentApp[key]=value);appSurrogate=null,null==this.template&&(this.template=_JST["src/templates/app.html"]),$win=$(window),$win.on("resize.appResize-"+this.cid,function(){return _this.set({windowWidth:$win.width(),windowHeight:$win.height(),documentWidth:document.width,documentHeight:document.height})}),App.__super__.constructor.apply(this,arguments)}return __extends(App,_super),App.prototype.require=function(){},App.prototype.destroy=function(){return Base.$(window).off("resize.appResize-"+this.cid),App.__super__.destroy.apply(this,arguments)},App.prototype.define=function(){},App.prototype.init=function(options){return null==options&&(options=this.options),this.trigger("init",options)},App.prototype.broadcast=function(){var args,child,eventName,_i,_len,_ref,_results;if(eventName=arguments[0],args=2<=arguments.length?__slice.call(arguments,1):[],this.children&&!/^(child:|request:|firstParent:|firstChild:)/.test(eventName)){for(_ref=this.children,_results=[],_i=0,_len=_ref.length;_len>_i;_i++)child=_ref[_i],_results.push(child.trigger.apply(child,["app:"+eventName].concat(__slice.call(args))));return _results}},App.prototype.moduleType="app",App}(Base.View),moduleTypes=["model","view","singleton","collection","app","module","component","service","filter"],prepareModule=function(module){var fn;return"function"!=typeof module?(fn=module.pop(),fn.dependencies=module):fn=module,fn},getModuleArgs=function(depStrings){return depStrings.map(function(item){var split,type,_i,_len;if(split=item.split("."),split[1])return Base[split[0]](split[1]);for(_i=0,_len=moduleTypes.length;_len>_i;_i++)if(type=moduleTypes[_i],item.lastIndexOf(capitalize(type))+type.length===item.length)return Base[item](type.substring(0,type.length-item.length-1))})},invokeModule=function(module){return"function"==typeof module?invokeWithArgs(module,getModuleArgs(module.dependencies||[])):void 0},invokeWithArgs=function(constructor,args){var Func;return Func=function(){return constructor.apply(null,args)},Func.prototype=constructor.prototype,new Func},moduleQueue=[],_ref=[Base.App.prototype,Base],_fn=function(subject){var type,_j,_len1,_results;for(_results=[],_j=0,_len1=moduleTypes.length;_len1>_j;_j++)type=moduleTypes[_j],_results.push(function(type){var _name;return null==subject[_name=""+type+"s"]&&(subject[_name]={}),subject[type]=function(name,module){var deps,index,indexesToSplice,item,modifier,_base,_k,_l,_len2,_len3,_ref1,_results1;if("string"==typeof name&&!module)return subject[type][capitalize(name)];if(!name||!module)throw module=name,module=prepareModule(module),name=module.name||module.prototype.name,new Error("Modules must have a name");for(module=prepareModule(module),module.prototype&&null==(_base=module.prototype).name&&(_base.name=name),null==module.name&&(module.name=name),subject[type][capitalize(name)]=module,"function"==typeof module&&null==module.dependencies&&(module.dependencies=Base.utils.getFunctionArgNames(module)),module.dependencies&&module.dependencies.length&&moduleQueue.push({name:name,dependencies:_.clone(module.dependencies),module:module}),indexesToSplice=[],index=_k=0,_len2=moduleQueue.length;_len2>_k;index=++_k)item=moduleQueue[index],deps=item.dependencies,_ref1=""+item.name+"{capitalize type}",__indexOf.call(deps,_ref1)>=0&&(index=deps.indexOf(""+item.name+"{capitalize type}"),deps.splice(index,1),deps.length||(indexesToSplice.push(index),invokeModule(module)));for(modifier=0,_results1=[],_l=0,_len3=indexesToSplice.length;_len3>_l;_l++)index=indexesToSplice[_l],_results1.push(moduleQueue.splice(index-modifier++,1));return _results1}}(type));return _results},_i=0,_len=_ref.length;_len>_i;_i++)subject=_ref[_i],_fn(subject);for(Base.Model=function(_super){function Model(defaults,options){var key,value,_ref1,_this=this;null==defaults&&(defaults={}),null==options&&(options={}),null==this.name&&(this.name=this.constructor.name),this instanceof Base.State||(null==this.relations&&(this.relations={}),this.relations.$state=Base.State),this._mapRelations(_.extend({},this.relations,options.relations)),Model.__super__.constructor.apply(this,arguments),_ref1=_.extend(options.compute||{},this.compute);for(key in _ref1)value=_ref1[key],this.computeProperty(key,value);addState(this),Base.config.debug.logModelChanges&&this.on("change",function(){var e;try{return console.info(JSON.stringify(_this.toJSON(),null,2))}catch(_error){return e=_error,console.info(e)}})}return __extends(Model,_super),Model.prototype.destroy=function(){return this.off(),this.stopListening(),Model.__super__.destroy.apply(this,arguments)},Model.prototype.blacklist=[],Model.prototype._mapRelations=function(relations){var isCollection,key,newRelations,value;if(null==relations&&(relations=this.relations),null==this.defaults&&(this.defaults={}),relations&&!_.isArray(relations)){newRelations=[];for(key in relations){for(value=relations[key],isCollection=!1,_super=value;_super=_super.__super__;)_super&&_super.initialize===Backbone.Collection.prototype.initialize&&(isCollection=!0);newRelations.push({key:key,type:isCollection?"Many":"One",collectionType:isCollection?value:void 0,relatedModel:isCollection?value.prototype.model:value})}return this.relations=newRelations}},Model.prototype.toJSON=function(withBlacklist){var json;return json=Backbone.AssociatedModel.prototype.toJSON.call(this,withBlacklist),withBlacklist?json:_.omit(json,this.blacklist)},Model.prototype.computeProperty=function(name,args){var callback,obj,trigger,_j,_len1,_ref1,_this=this;switch(args=_.clone(args),type(args)){case"object":obj=args;break;case"array":obj={fn:args.pop(),triggers:args}}for(this.blacklist.push(name),callback=function(){var result,values;return values=obj.triggers.map(function(trigger){return _this.get(trigger)}),result=obj.fn.apply(_this,values),_this.set(name,result)},_ref1=obj.triggers,_j=0,_len1=_ref1.length;_len1>_j;_j++)trigger=_ref1[_j],this.on("change:"+trigger,callback);try{return callback()}catch(_error){}},Model.prototype.toggle=function(attr){return this.set(attr,!this.get(attr))},Model.prototype.moduleType="model",Model}(Backbone.AssociatedModel),Base.State=function(_super){function State(attributes,options,context){var key,value,_ref1;if(null==options&&(options={}),null==this.relations&&(this.relations={}),context&&context.relations){_ref1=context.relations;for(key in _ref1)value=_ref1[key],this.relations[key]=value}null==this.compute&&(this.compute=options.compute),State.__super__.constructor.call(this,attributes,options),this.parent=this.parents[0]||options.parent||context||attributes.parent,null==this.name&&(this.name=lowercase(this.constructor.name)),this.parent&&this.on("all",function(){var _this=this;return function(){var args,event,_ref2;return event=arguments[0],args=2<=arguments.length?__slice.call(arguments,1):[],(_ref2=_this.parent).trigger.apply(_ref2,["state:"+event].concat(__slice.call(args)))}})}return __extends(State,_super),State}(Base.Model),Base.Object=function(){function Object(){}return Object}(),_.extend(Base.Object.prototype,Backbone.Events),Base.Stated=function(_super){function Stated(){this.addState(this),Stated.__super__.constructor.apply(this,arguments)}return __extends(Stated,_super),Stated}(Base.Object),Base.Router=function(_super){function Router(){var _this=this;null==this.name&&(this.name=this.constructor.name),this.stateOptions=_.defaults(this.stateOptions||{},{relations:this.relations,compute:this.compute}),addState(this),Router.__super__.constructor.apply(this,arguments),this.get("params")||this.set("params",{}),currentApp.router=this,this.on("route",function(router,route,params){var index,item,queryParams,split,_j,_len1;for(_this.set("route",route.join("/")),_this.set("path",route),queryParams={},split=(location.href.split("?")[1]||"").split(/[&=]/),index=_j=0,_len1=split.length;_len1>_j;index=++_j)item=split[index],index%2||!item||(queryParams[decodeURI(item)]=decodeURI(split[index+1]));return _this.set("params",params),_this.set("queryParams",queryParams)})}return __extends(Router,_super),Router.prototype.setParams=function(obj,reset){var params;return params=reset?{}:this.get("params"),_.extend(params,obj),this.set("params",obj)},Router.prototype.relations={params:Base.Model},Router.prototype.go=function(route){return this.navigate(route,!0)},Router.prototype.destroy=function(){return this.off(),this.stopListening()},Router.prototype.moduleType="router",Router}(Backbone.Router),Base.Collection=function(_super){function Collection(){Collection.__super__.constructor.apply(this,arguments),null==this.name&&(this.name=this.constructor.name),addState(this)}return __extends(Collection,_super),Collection.prototype.destroy=function(){return this.off(),this.stopListening()},Collection.prototype.model=Base.Model,Collection.prototype.moduleType="collection",Collection}(Backbone.Collection),Base.Singleton=function(_super){function Singleton(){var _base,_name,_this=this;Singleton.__super__.constructor.apply(this,arguments),null==(_base=currentApp||appSurrogate)[_name=uncapitalize(this.name)]&&(_base[_name]=this),(currentApp||appSurrogate).singletons[uncapitalize(this.name)]=this,this.on("all",function(){var args,eventName;return eventName=arguments[0],args=2<=arguments.length?__slice.call(arguments,1):[],currentApp?currentApp.trigger.apply(currentApp,[""+uncapitalize(_this.name)+":"+eventName].concat(__slice.call(args))):void 0})}return __extends(Singleton,_super),Singleton}(Base.Model),Base.List=function(){function List(items,options){null==options&&(options={}),this.reset(items,options),options.noState||addState(this),_.isFunction(this.initialize)&&this.initialize.apply(this,arguments)}return List.prototype.unshift=function(){var item,items,_j,_len1,_ref1,_results;for(items=1<=arguments.length?__slice.call(arguments,0):[],_ref1=items.reverse(),_results=[],_j=0,_len1=_ref1.length;_len1>_j;_j++)item=_ref1[_j],_results.push(this.add(item,{at:0}));return _results},List.prototype.push=function(){var item,items,_j,_len1,_results;for(items=1<=arguments.length?__slice.call(arguments,0):[],_results=[],_j=0,_len1=items.length;_len1>_j;_j++)item=items[_j],_results.push(this.add(item,{at:this.length}));return _results},List.prototype.shift=function(){return this.remove(null,{at:0})},List.prototype.pop=function(){return this.remove(null,{at:this.length-1})},List.prototype.empty=function(){return this.splice(0,1/0)},List.prototype.eventNamespace="listItem:",List.prototype.bubbleEvents=!0,List.prototype.reset=function(items,options){return null==options&&(options={}),this.splice(this.length,this.length),this.push.apply(this,items),options.silent?void 0:this.trigger("reset",this,options)},List.prototype.add=function(item,options){var at,_this=this;return null==options&&(options={}),at=null!=options.at?options.at:options.at=this.length,this.bubbleEvents&&item&&_.isFunction(item.on)&&this.listenTo(item,"all",function(){var args,eventName;return eventName=arguments[0],args=2<=arguments.length?__slice.call(arguments,1):[],_this.bubbleEvents?_this.trigger.apply(_this,[""+_this.eventNamespace+_this.eventName].concat(__slice.call(args))):void 0}),this.model&&(item=new this.model(item)),this.splice(at,null,item),options.silent?void 0:this.trigger("add",item,this,options)},List.prototype.remove=function(item,options){var index;return null==options&&(options={}),index=options.at||this.indexOf(item),null==item&&(item=this[index]),this.splice(index,1),options.silent||this.trigger("remove",item,this,options),this.stopListening(item)},List}(),_.extend(Base.List.prototype,Backbone.Events),_ref1=["splice","indexOf","lastIndexOf","join","reverse","sort","valueOf","map","forEach","every","reduce","reduceRight","filter","some"],_j=0,_len1=_ref1.length;_len1>_j;_j++)method=_ref1[_j],Base.List.prototype[method]||(Base.List.prototype[method]=arr[method]);for(_ref2=["each","contains","find","filter","reject","contains","max","min","sortBy","groupBy","sortedIndex","shuffle","toArray","size","first","last","initial","rest","without","isEmpty","chain","where","findWhere","clone","pluck","invoke"],_k=0,_len2=_ref2.length;_len2>_k;_k++)method=_ref2[_k],Base.List.prototype[method]||(Base.List.prototype[method]=_[method]);for(Base.Event=function(){function Event(options){this.options=options,_.extend(this,this.options),null==this.currentTarget&&(this.currentTarget=this.target)}return Event.prototype.preventDefault=function(){return this.defaultPrevented=!0},Event.prototype.stopPropagation=function(){return this.propagationStopped=!0},Event}(),_ref3=["View","Router"],_l=0,_len3=_ref3.length;_len3>_l;_l++)for(moduleType=_ref3[_l],_ref4=["get","set","toJSON","has","unset","escape","changed","clone","keys","values","pairs","invert","pick","omit","clear","toggle"],_fn1=function(method){var _base;return null!=(_base=Base[moduleType].prototype)[method]?(_base=Base[moduleType].prototype)[method]:_base[method]=function(){var args,_ref5;return args=1<=arguments.length?__slice.call(arguments,0):[],(_ref5=this.state)[method].apply(_ref5,args)
}},_m=0,_len4=_ref4.length;_len4>_m;_m++)method=_ref4[_m],_fn1(method);for(BasicView=function(_super){function BasicView(options){var data,html,view,_this=this;null==options&&(options={}),null==this.name&&(this.name=options.name||(options.model&&options.model.name?options.model.name+":view":void 0)),view=options.view,html=options.html,data=options.data,this.ractive=!!view.ractive,options.path&&(this.relations={model:view.get(options.path).model}),null==this.template&&(this.template=html),BasicView.__super__.constructor.apply(this,arguments),options.model&&this.set("model",options.model),this.set("html",html(html?this.render():void 0)),data&&(data.toJSON?(this.set(data.toJSON()),this.listenTo(data,"all",function(eventName){var eventType,keypath,split;return split=eventName.split(":"),eventType=split[0],keypath=split[1],"change"===eventType&&keypath?_this.set(keyPath,data.get(keyPath)):void 0})):this.set(data))}return __extends(BasicView,_super),BasicView}(Base.View),type=function(obj){return{}.toString.call(obj).match(/\s([a-zA-Z]+)/)[1].toLowerCase()},dasherize=function(str){return str.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()},camelize=function(str){return str.replace(/[^\d\w]+(.)?/g,function(match,chr){return chr?chr.toUpperCase():""})},deserialize=function(value){var e;try{return value?"true"===value?!0:"false"===value?!1:"null"===value?null:isNaN?/^[\[\{]/.test(value)?JSON.parse(value):value:Number(value):value}catch(_error){return e=_error,value}},capitalize=function(str){return str?str[0].toUpperCase()+str.substring(1):""},addState=function(obj){var state,stateAttributes,_this=this;return obj instanceof Base.State?void 0:(stateAttributes=obj.state||{},null==obj.blacklist&&(obj.blacklist=[]),obj.blacklist.push("$state"),obj instanceof Base.Model?(obj.set("$state",_.defaults(stateAttributes,obj.stateDefaults)),state=obj.state=obj.get("$state")):(stateAttributes=_.defaults(stateAttributes,obj.stateDefaults||obj.defaults),state=obj.state=new Base.State(stateAttributes,obj.stateOptions,obj),null==state.associations&&(state.associations=[]),state.associations.push({type:"one",key:"$parent",relatedModel:Base.State}),this.parent&&this.parent.state&&(state.set("$parent",this.parent.state.toJSON()),this.listenTo(this.parent.state,"all",function(eventName){var split;return split=eventName.split(":"),"change"===split[0]&&split[1]?_this.set("$parent."+split[1],_this.parent.state.get(split[1])):void 0}))),obj instanceof Base.View&&state.set("$state",state),state.on("all",function(){var args,eventName,split;return eventName=arguments[0],args=2<=arguments.length?__slice.call(arguments,1):[],split=eventName.split(":"),"change"===split[0]&&split[1]?obj.trigger.apply(obj,["change:$state."+split[1]].concat(__slice.call(args))):void 0}))},uncapitalize=function(str){return str?str[0].toLowerCase()+str.substring(1):""},Base.components={collection:function($el,view,attrs){var View,collection,collectionViews,html,insertView,name,path,_this=this;return null==attrs&&(attrs={}),path=attrs.path||attrs.collection,name=attrs.name,View=currentApp.views[capitalize(attrs.view)]||BasicView,html=$el.html(),$el.empty(),insertView=function(model){var newView;return newView=new View(_.extend({data:model,html:html,view:view,parent:_this,name:name,path:path,model:model},attrs)),null==newView.model&&(newView.model=model),newView.set("model",model),_this.subView(newView),newView.render(!0),collectionViews.push(newView),$el.append(newView.$el)},collectionViews=[],this.on("add:"+path,insertView),this.on("remove:"+path,function(model){return _this.childView(function(view){return view.model===model}).destroy()}),this.on("reset:"+path,function(models){var _len5,_n;for(_n=0,_len5=collectionViews.length;_len5>_n;_n++)view=collectionViews[_n],view.destroy();return collectionViews=[],models.each(insertView)}),collection=this.get(path),collection?collection.each(insertView):void 0},view:function($el,view,attrs){var View,data,html,name,newView,viewName;return viewName=attrs.view||attrs.type,View=currentApp.views[capitalize(camelize(viewName))]||BasicView,name=attrs.name,data=this.get(attrs.data)||view.state,html=$el.html(),$el.empty(),newView=new View(_.extend({html:html,view:view,name:name,data:data},attrs)),newView.render(!0),this.subView(newView),$el.append(newView.$el)},icon:function(){},"switch":function(){},log:function($el,view,attrs){var key,out,value;out={};for(key in attrs)value=attrs[key],out[key]=this.get(value);return console.info("base-log:",out),$el.remove()},list:function(){}},Base.plugins={view:{ractive:function(){},actions:function(){var event,_len5,_n,_results,_this=this;for(_results=[],_n=0,_len5=DOMEventList.length;_len5>_n;_n++)event=DOMEventList[_n],_results.push(function(event){var callback;return callback=function(e){var $target,action,cb;return $target=$(e.currentTarget),action=$target.attr("action-"+event)||$target.attr("data-action-"+event),cb=_this._getCallback(action),cb.call(_this)},_this.$el.on(event,"[data-action-"+event+"], [action-"+event+"]",_.debounce(callback,1,!0))}(event));return _results},inherit:function(){var path,_fn2,_len5,_n,_ref5,_this=this;if(this.inherit){for(_ref5=this.inherit,_fn2=function(path){return _this.set(path,_this.lookup(path)),_this.on("parent:change:"+path,function(event,model,value){return _this.set(path,value)})},_n=0,_len5=_ref5.length;_len5>_n;_n++)path=_ref5[_n],_fn2(path);return null}},map:function(){var key,val,_fn2,_ref5,_this=this;if(this.map){_ref5=this.map,_fn2=function(key,val){return _this.set(key,_this.lookup(val)),_this.on("parent:change:"+value,function(event,model,value){return _this.set(key,value)})};for(key in _ref5)val=_ref5[key],_fn2(key,val);return null}},outlets:function(){var boundOutlets,_this=this;return boundOutlets=[],this.on("render",function(){var $el,$items,el,nodes,outlet,outlets,outletsArr,_len5,_n,_results;for(nodes=(_this.ractive.fragment.items||[]).map(function(item){return item.node}),$items=$("[outlet], [base-outlet]",nodes),_results=[],_n=0,_len5=$items.length;_len5>_n;_n++)el=$items[_n],$el=$(el),outlets=camelize($el.attr("base-outlet")||$el.attr("outlet")),outletsArr=outlets.split(/\s/),_results.push(function(){var _len6,_o,_results1,_this=this;for(_results1=[],_o=0,_len6=outlets.length;_len6>_o;_o++)outlet=outlets[_o],_results1.push(function(outlet){var eventName,events,key,outletEventRe,outletMethodRe,value,_ref5;if(__indexOf.call(boundOutlets,outlet)<0){boundOutlets.push(outlet),_this.$[outlet]=_this.$("[base-outlet~='"+outlet+"'], [outlet~='"+outlet+"']"),events=[],outletMethodRe=new RegExp("on(.*)?"+outlet,"i");for(key in _this)value=_this[key],outletMethodRe.test(key)&&events.push(RegExp.$1.toLowerCase());outletEventRe=new RegExp("^([^:]*?):"+outlet,"i"),_ref5=_this._events;for(key in _ref5)value=_ref5[key],outletEventRe.test(key)&&events.push(RegExp.$1.toLowerCase());return eventName=events.join(" ")+".delegateEvents",_this.$el.on(eventName,"[data-outlet="+outlet+"]",function(e){return _this.trigger([event.type,outlet].join(":"),e)})}}(outlet));return _results1}.call(_this));return _results})}},all:{state:function(){},localStore:function(module,config){var attrs,getStore,name,omit,setStore,store,_this=this;return store=Base.utils.store,name=config.id||this.name,attrs=config.attributes,omit=config.omit,getStore=function(fullStateStore){var currentStore,thisStore;return currentStore=store.getItem("stateStore"),thisStore=null!=currentStore[name]?currentStore[name]:currentStore[name]={},fullStateStore?currentStore:thisStore},setStore=function(){var currentStore,data;return currentStore=getStore(!0),data=_this.toJSON(),attrs&&(data=_.pick(data,attrs)),omit&&(data=_.omit(attrs,data)),_.extend(currentStore[name],data),store.setItem("stateStore",currentStore)},this.set(getStore()),this.on("change",setStore)}}},Base.plugins.all.localStore.clear=Base.plugins.all.localStore.clearItem=function(id){var newStore,store;return store=Base.utils.store,newStore=id?store.getItem("stateStore"):{},id&&(newStore[id]={}),store.setItem("stateStore",newStore)},Base.filters={uncapitalize:uncapitalize,capitalize:capitalize,uppercase:function(str){return str.toUpperCase()},lowercase:function(str){return str.toLowerCase()},json:function(obj){return JSON.stringify(obj,null,2)},orderBy:function(arr,property,reverse){return arr=arr.sort(function(item){return item[property]}),reverse?arr.reverse():arr}},Base.defaults={all:{plugins:{state:!0}},view:{plugins:{actions:!1,outlets:!0,filters:!0,ractive:!0,components:!0,manage:!0,inherit:!0,map:!0,eventSugar:!0}},model:{plugins:{}},router:{plugins:{}},collection:{plugins:{}}},_ref5=["Model","Router","Collection","View","Stated","App","List"],_n=0,_len5=_ref5.length;_len5>_n;_n++)for(className=_ref5[_n],_ref6=["get","set","on","listenTo","off","stopListening","once","listenToOnce","trigger","clear","has","invert","omit","pick","sync","fetch","save","changed","validate","isValid","clone","hasChanged","previous","destroy"],_fn2=function(method){return Base[className].prototype["state"+capitalize(method)]=function(){var args,_ref7;return args=1<=arguments.length?__slice.call(arguments,0):[],(_ref7=this.state)[method].apply(_ref7,args)}},_o=0,_len6=_ref6.length;_len6>_o;_o++)method=_ref6[_o],_fn2(method);for(Base.Controller=Base.View,window.Base=Base,Base.utils={store:{getItem:function(name){return JSON.parse(localStorage.getItem(name))},setItem:function(name,val){return localStorage.setItem(name,JSON.stringify(val))},extendItem:function(name,val){return this.lsSetItem(_.extend(this.lsGetItem(name)||{},val))}},camelize:camelize,dasherize:dasherize,capitalize:capitalize,uncapitalize:uncapitalize,deserialize:deserialize,types:type,getFunctionArgNames:function(fn){return fn.toString().match(/\(.*?\)/)[0].replace(/[()\s]/g,"").split(",")}},_ref7=["List","Object","Event"],_p=0,_len7=_ref7.length;_len7>_p;_p++)module=_ref7[_p],null==(_base=Base[module].prototype).extend&&(_base.extend=Backbone.Model.prototype.extend);Base.define=Base.service,Base.require=function(name,appContext){null==appContext&&(appContext=null)},Base.define=function(name,appContext){null==appContext&&(appContext=null)},Base._super=function(context,methodName,args){return context.constructor.__super__[methodName].apply(context,args)},parseRequirements=function(fn){return fn.toString().match(/require\('.*?'\)/g).map(function(item){return item.match(/require\('(.*?)'\)/)[1]})},Base.services.require=function(string){var accessor,camelSplit,moduleName,_len8,_q,_ref8;if(camelSplit=string.split(/(?![a-z])(?=[A-Z])/),moduleType=_.last(camelSplit).toLowerCase(),__indexOf.call(moduleTypes,moduleType)>=0)return moduleName=string.substring(0,string.length-camelSplit.length),accessor=""+moduleType+"s",currentApp[accessor][moduleName]||Base[accessor][moduleName];for(moduleName=string,_ref8=["app","singleton","service","module","object"],_q=0,_len8=_ref8.length;_len8>_q;_q++)if(type=_ref8[_q],module=currentApp[type][moduleName]||Base[type][moduleName])return module},null==Base.apps&&(Base.apps={}),Base.$(function(){return Base.$("[base-app]").each(function(index,el){var App,app,name;return name=el.getAttribute("base-app"),App=Base.apps[capitalize(name)],app=Base.apps[uncapitalize(name)],app&&app.el===el?void 0:new App({el:el})})})}.call(this);